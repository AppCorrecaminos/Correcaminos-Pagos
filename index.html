<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Correcaminos - Plataforma de Pagos</title>
    <meta name="description"
        content="Plataforma para informar el pago de cuotas de Correcaminos. Actividades de atletismo y cuota social.">
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- CSS -->
    <link rel="stylesheet" href="css/styles.css">
    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Firebase SDK (Version Compat para m√°xima compatibilidad local) -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

    <!-- Traducimos la API modular a algo que los scripts actuales entiendan -->
    <script>
        // Guardamos el Firebase original (SDK) para no perderlo
        const _realFirebase = window.firebase;

        window.firebase = {
            app: {
                initializeApp: (config) => _realFirebase.initializeApp(config)
            },
            auth: {
                getAuth: (app) => _realFirebase.auth(),
                signInWithEmailAndPassword: (auth, email, pass) => auth.signInWithEmailAndPassword(email, pass),
                signOut: (auth) => auth.signOut(),
                onAuthStateChanged: (auth, cb) => auth.onAuthStateChanged(cb)
            },
            firestore: {
                getFirestore: (app) => _realFirebase.firestore(),
                doc: (db, coll, id) => db.collection(coll).doc(id),
                collection: (db, coll) => db.collection(coll),
                getDoc: (docRef) => docRef.get(),
                setDoc: (docRef, data) => docRef.set(data),
                updateDoc: (docRef, data) => docRef.update(data),
                query: (collRef, ...constraints) => collRef,
                where: (field, op, val) => ({ field, op, val }),
                orderBy: (field, dir) => ({ field, dir }),
                getDocs: (query) => query.get(),
                addDoc: (collRef, data) => collRef.add(data),
                deleteDoc: (docRef) => docRef.delete(),
                onSnapshot: (query, cb, err) => query.onSnapshot(cb, err)
            }
        };
    </script>
</head>

<body>
    <div id="app">
        <!-- Login View -->
        <section id="login-view" class="view active">
            <div class="login-container">
                <div class="login-card">
                    <div class="login-header">
                        <img src="img/Logo Correcaminos.jpeg" alt="Correcaminos Logo" class="login-logo">
                        <h1>Bienvenido</h1>
                        <p>Ingresa tus credenciales para continuar</p>
                    </div>
                    <form id="login-form">
                        <div class="form-group">
                            <label for="username">Usuario</label>
                            <div class="input-icon">
                                <i class="fas fa-user"></i>
                                <input type="text" id="username" placeholder="Tu nombre de usuario" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="password">Contrase√±a</label>
                            <div class="input-icon">
                                <i class="fas fa-lock"></i>
                                <input type="password" id="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
                            </div>
                        </div>
                        <button type="submit" class="btn-primary">Iniciar Sesi√≥n</button>
                    </form>
                </div>
            </div>
        </section>

        <!-- Main Dashboard View (Parent/User) -->
        <section id="user-view" class="view">
            <nav class="navbar">
                <div class="nav-content">
                    <div class="nav-brand">
                        <img src="img/Logo Correcaminos.jpeg" alt="Logo" class="nav-logo">
                        <div class="brand-text">
                            <span class="brand-main">Asociacion Civil Correcaminos - JF Running</span>
                            <span class="brand-sub">Escuela de Atletismo Correcaminos</span>
                        </div>
                    </div>
                    <div class="nav-user">
                        <div id="db-status" class="db-status" title="Estado de la base de datos">
                            <i class="fas fa-circle"></i> <span id="db-status-text">Conectando...</span>
                        </div>
                        <span id="user-display-name">Padre de Familia</span>
                        <button class="btn-logout" id="logout-btn">
                            <i class="fas fa-sign-out-alt"></i>
                        </button>
                    </div>
                </div>
            </nav>

            <main class="container">
                <header class="dashboard-header">
                    <h2>Mi Perfil</h2>
                    <p>Gestiona los pagos de tu hijo/a</p>
                </header>

                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon athletics"><i class="fas fa-running"></i></div>
                        <div class="stat-info">
                            <span class="stat-label">Cuota Actividades</span>
                            <span class="stat-value" id="fee-athletics">$0</span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon social"><i class="fas fa-users"></i></div>
                        <div class="stat-info">
                            <span class="stat-label">Cuota Social</span>
                            <span class="stat-value" id="fee-social">$0</span>
                        </div>
                    </div>
                    <div class="stat-card highlight">
                        <div class="stat-icon total"><i class="fas fa-calendar-check"></i></div>
                        <div class="stat-info">
                            <span class="stat-label">Estado de Cuenta</span>
                            <span class="stat-value" id="user-cc-status">Al D√≠a</span>
                        </div>
                    </div>
                </div>

                <!-- Yearly Timeline for Parents -->
                <div class="card" style="margin-bottom: 2rem;">
                    <div class="card-header">
                        <h3>Mi Estado Anual (Febrero - Diciembre)</h3>
                    </div>
                    <div class="card-body">
                        <div class="yearly-timeline" id="user-yearly-timeline">
                            <!-- month items will be generated here -->
                        </div>
                    </div>
                </div>

                <div id="breakdown-container" class="dashboard-content" style="margin-bottom: 2rem;">
                    <!-- Tabla de desglose por hijo se insertar√° aqu√≠ -->
                </div>

                <!-- Section for Athlete Profiles -->
                <div class="card" style="margin-bottom: 2rem;">
                    <div class="card-header"
                        style="display: flex; justify-content: space-between; align-items: flex-start;">
                        <div>
                            <h3>Ficha de Datos - Mis Atletas</h3>
                            <p class="text-xs">Completa los datos de cada atleta para el seguro y registros t√©cnicos.
                            </p>
                        </div>
                        <button id="btn-add-athlete-manually" class="btn-primary btn-sm">
                            <i class="fas fa-plus"></i> A√±adir Atleta
                        </button>
                    </div>
                    <div class="card-body">
                        <div id="athletes-container" class="athletes-grid">
                            <!-- Athlete cards will be generated here -->
                        </div>
                    </div>
                </div>

                <div class="dashboard-content">
                    <div class="card payment-history">
                        <div class="card-header">
                            <h3>Historial de Pagos</h3>
                            <button class="btn-primary btn-sm" id="btn-report-payment">
                                <i class="fas fa-plus"></i> Informar Pago
                            </button>
                        </div>
                        <div class="table-responsive">
                            <table id="payments-table">
                                <thead>
                                    <tr>
                                        <th>Mes</th>
                                        <th>Fecha</th>
                                        <th>Monto</th>
                                        <th>Estado</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </main>
        </section>

        <!-- Admin View -->
        <section id="admin-view" class="view">
            <nav class="navbar">
                <div class="nav-content">
                    <div class="nav-brand">
                        <img src="img/Logo Correcaminos.jpeg" alt="Logo" class="nav-logo">
                        <div class="brand-text">
                            <span class="brand-main">Asociacion Civil Correcaminos - JF Running</span>
                            <span class="brand-sub">Escuela de Atletismo Correcaminos (Admin)</span>
                        </div>
                    </div>
                    <div class="nav-menu">
                        <button class="nav-link active" data-target="admin-reports">Reportes</button>
                        <button class="nav-link" data-target="admin-cc">Cuenta Corriente</button>
                        <button class="nav-link" data-target="admin-users">Usuarios</button>
                        <button class="nav-link" data-target="admin-config">Configuraci√≥n</button>
                    </div>
                    <div class="nav-user">
                        <div id="db-status-admin" class="db-status" title="Estado de la base de datos">
                            <i class="fas fa-circle"></i> <span id="db-status-text-admin">...</span>
                        </div>
                        <span>Administrador</span>
                        <button class="btn-logout" id="admin-logout-btn">
                            <i class="fas fa-sign-out-alt"></i>
                        </button>
                    </div>
                </div>
            </nav>

            <main class="container">
                <div id="admin-reports" class="admin-tab active">
                    <header class="dashboard-header">
                        <div class="header-left">
                            <h2>Reporte de Cobros</h2>
                            <p>Resumen mensual de todos los pagos realizados</p>
                        </div>
                    </header>

                    <div class="stats-grid" id="admin-stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon athletics"><i class="fas fa-clock"></i></div>
                            <div class="stat-info">
                                <span class="stat-label">Pendientes de revisi√≥n</span>
                                <span class="stat-value" id="stat-pending">0</span>
                            </div>
                        </div>
                        <div class="stat-card highlight">
                            <div class="stat-icon total"><i class="fas fa-hand-holding-dollar"></i></div>
                            <div class="stat-info">
                                <span class="stat-label">Total Cobrado (Mes)</span>
                                <span class="stat-value" id="stat-total">$ 0</span>
                            </div>
                        </div>
                    </div>

                    <div class="card filters-card">
                        <div class="filters-row">
                            <div class="filter-group">
                                <label>Estado:</label>
                                <select id="filter-status">
                                    <option value="all">Todos</option>
                                    <option value="pending">Pendientes</option>
                                    <option value="approved">Aprobados</option>
                                    <option value="rejected">Rechazados</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <label>Mes:</label>
                                <select id="filter-month">
                                    <option value="all">Todos los meses</option>
                                    <option value="Enero">Enero</option>
                                    <option value="Febrero">Febrero</option>
                                    <option value="Marzo">Marzo</option>
                                    <option value="Abril">Abril</option>
                                    <option value="Mayo">Mayo</option>
                                    <option value="Junio">Junio</option>
                                    <option value="Julio">Julio</option>
                                    <option value="Agosto">Agosto</option>
                                    <option value="Septiembre">Septiembre</option>
                                    <option value="Octubre">Octubre</option>
                                    <option value="Noviembre">Noviembre</option>
                                    <option value="Diciembre">Diciembre</option>
                                </select>
                            </div>
                            <button id="btn-export-csv" class="btn-text">
                                <i class="fas fa-file-export"></i> Exportar Excel (CSV)
                            </button>
                        </div>
                    </div>

                    <div class="card">
                        <div class="table-responsive">
                            <table id="admin-payments-table">
                                <thead>
                                    <tr>
                                        <th>Fecha</th>
                                        <th>Usuario</th>
                                        <th>Mes</th>
                                        <th>Monto</th>
                                        <th>Foto</th>
                                        <th>Estado</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div id="admin-cc" class="admin-tab">
                    <header class="dashboard-header">
                        <div class="header-left">
                            <h2>Cuenta Corriente</h2>
                            <p>Estado de deudas y cobros (Mes actual y pr√≥ximo)</p>
                        </div>
                    </header>

                    <div class="card">
                        <div class="table-responsive">
                            <table id="admin-cc-table">
                                <thead>
                                    <tr>
                                        <th>Usuario</th>
                                        <th class="month-col">Feb</th>
                                        <th class="month-col">Mar</th>
                                        <th class="month-col">Abr</th>
                                        <th class="month-col">May</th>
                                        <th class="month-col">Jun</th>
                                        <th class="month-col">Jul</th>
                                        <th class="month-col">Ago</th>
                                        <th class="month-col">Sep</th>
                                        <th class="month-col">Oct</th>
                                        <th class="month-col">Nov</th>
                                        <th class="month-col">Dic</th>
                                        <th>Deuda Total</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Datos de CC se cargar√°n aqu√≠ -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div id="admin-users" class="admin-tab">
                    <header class="dashboard-header">
                        <div class="header-left">
                            <h2>Gesti√≥n de Usuarios</h2>
                            <p>Lista de padres y alumnos registrados</p>
                        </div>
                        <div class="header-right" style="display: flex; gap: 1rem;">
                            <button class="btn-text" id="btn-export-athletes">
                                <i class="fas fa-file-export"></i> Exportar Atletas (Excel)
                            </button>
                            <button class="btn-primary" id="btn-add-user">
                                <i class="fas fa-user-plus"></i> Nuevo Usuario
                            </button>
                        </div>
                    </header>
                    <div class="card">
                        <div class="table-responsive">
                            <table id="admin-users-table">
                                <thead>
                                    <tr>
                                        <th>Nombre / Alumno</th>
                                        <th>Email / Usuario</th>
                                        <th>Rol</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Usuarios se cargar√°n aqu√≠ -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div id="admin-config" class="admin-tab">
                    <header class="dashboard-header">
                        <h2>Configuraci√≥n General</h2>
                        <p>Gestiona los valores de las cuotas y las actividades disponibles</p>
                    </header>

                    <div class="config-grid">
                        <!-- Valores Base -->
                        <div class="card">
                            <div class="card-header">
                                <h3>Cuota Social Base</h3>
                            </div>
                            <form id="config-fees-form" class="card-body">
                                <div class="form-group">
                                    <label for="config-social">Valor Cuota Social ($)</label>
                                    <input type="number" id="config-social" value="5000" required>
                                </div>
                                <div class="form-grid-2">
                                    <div class="form-group">
                                        <label for="config-late-fee">Recargo por Mora ($)</label>
                                        <input type="number" id="config-late-fee" value="5000" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="config-late-day">D√≠a L√≠mite Pago (1-31)</label>
                                        <input type="number" id="config-late-day" value="12" min="1" max="31" required>
                                    </div>
                                </div>
                                <button type="submit" class="btn-primary">Guardar Configuraci√≥n General</button>

                                <div style="margin-top: 2rem; padding-top: 1rem; border-top: 1px solid #eee;">
                                    <p class="text-xs" style="margin-bottom: 0.5rem; color: #666;"><b>Herramientas de
                                            Datos:</b></p>
                                    <button id="btn-migrate-to-athletes" class="btn-text" type="button"
                                        style="color: var(--danger); font-weight: 600; text-align: left; width: 100%; border: 1px solid var(--danger); padding: 0.5rem; border-radius: 4px; margin-bottom: 0.5rem;">
                                        <i class="fas fa-magic"></i> Migrar Datos a Fichas T√©cnicas
                                    </button>
                                    <p class="text-xs" style="color: #999; margin-bottom: 1rem;">Convierte el texto de
                                        "Hijos" en carpetas individuales habilitando la carga de DNI y ficha completa.
                                    </p>

                                    <button id="btn-sync-to-cloud" class="btn-text" type="button"
                                        style="color: var(--secondary); font-weight: 600;">
                                        <i class="fas fa-cloud-upload-alt"></i> üì§ Respaldar datos actuales a la Nube
                                    </button>
                                </div>
                            </form>
                        </div>

                        <!-- Gesti√≥n de Actividades -->
                        <div class="card">
                            <div class="card-header"
                                style="display: flex; justify-content: space-between; align-items: center;">
                                <h3>Actividades y Costos</h3>
                                <button class="btn-primary btn-sm" id="btn-add-activity-row">
                                    <i class="fas fa-plus"></i> A√±adir Fila
                                </button>
                            </div>
                            <div class="card-body">
                                <p class="text-sm">Define las actividades y sus precios mensuales.</p>
                                <div class="table-responsive">
                                    <table id="activities-config-table">
                                        <thead>
                                            <tr>
                                                <th>Actividad</th>
                                                <th>Costo ($)</th>
                                                <th>C. Social?</th>
                                                <th></th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <!-- Filas de actividades din√°micas -->
                                        </tbody>
                                    </table>
                                </div>
                                <button id="btn-save-activities" class="btn-primary" style="margin-top: 1rem;">Guardar
                                    Actividades</button>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </section>

        <!-- Modal for Payment Reporting -->
        <div id="payment-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Informar Pago</h3>
                    <button class="close-modal">&times;</button>
                </div>
                <form id="payment-report-form">
                    <div class="form-group">
                        <label for="payment-month">Mes que abona</label>
                        <select id="payment-month" required>
                            <option value="">Seleccione un mes</option>
                            <!-- ... Meses ... -->
                            <option value="Enero">Enero</option>
                            <option value="Febrero">Febrero</option>
                            <option value="Marzo">Marzo</option>
                            <option value="Abril">Abril</option>
                            <option value="Mayo">Mayo</option>
                            <option value="Junio">Junio</option>
                            <option value="Julio">Julio</option>
                            <option value="Agosto">Agosto</option>
                            <option value="Septiembre">Septiembre</option>
                            <option value="Octubre">Octubre</option>
                            <option value="Noviembre">Noviembre</option>
                            <option value="Diciembre">Diciembre</option>
                        </select>
                    </div>
                    <div id="children-assignment" class="form-group">
                        <!-- Dynamic checkboxes for children will appear here -->
                    </div>
                    <div class="form-group">
                        <label for="payment-amount">Monto Total a Pagar ($)</label>
                        <input type="number" id="payment-amount" value="0">
                        <small id="payment-detail-text">Puedes editar el monto si es necesario.</small>
                    </div>
                    <div class="form-group">
                        <label for="payment-receipt">Foto del Comprobante</label>
                        <div class="file-upload" id="file-upload-zone">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p>Toca para seleccionar foto</p>
                            <input type="file" id="payment-receipt" accept="image/*" hidden>
                            <span id="file-name"></span>
                        </div>
                    </div>
                    <div class="modal-actions">
                        <button type="button" class="btn-text close-modal">Cancelar</button>
                        <button type="submit" class="btn-primary">Enviar Reporte de Pago</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Modal for New User -->
        <div id="user-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Registrar Nuevo Usuario</h3>
                    <button class="close-modal">&times;</button>
                </div>
                <form id="new-user-form">
                    <div class="form-group">
                        <label for="reg-name">Nombre del Padre / Madre</label>
                        <input type="text" id="reg-name" placeholder="Ej: Patricio Gomez" required>
                    </div>
                    <div class="form-group">
                        <label for="reg-email">Usuario (sin @)</label>
                        <input type="text" id="reg-email" placeholder="ej: patricio" required>
                    </div>
                    <div class="form-group">
                        <label for="reg-children">Nombres y Categor√≠as</label>
                        <textarea id="reg-children" placeholder="Ej: Juan (Infantil), Maria (Juvenil)" rows="2"
                            required></textarea>
                        <small>Usa el formato: Nombre (Categor√≠a)</small>
                    </div>
                    <div class="form-group">
                        <label for="reg-pass">Contrase√±a Inicial</label>
                        <input type="password" id="reg-pass" value="correcaminos123" required>
                    </div>
                    <div class="form-group">
                        <label for="reg-role">Rol</label>
                        <select id="reg-role">
                            <option value="user">Padre (Usuario)</option>
                            <option value="admin">Administrador</option>
                        </select>
                    </div>
                    <div class="modal-actions">
                        <button type="button" class="btn-text close-modal">Cancelar</button>
                        <button type="submit" class="btn-primary">Crear Usuario</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Modal para Editar Usuario -->
        <div id="edit-user-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Editar Usuario</h3>
                    <button class="close-modal">&times;</button>
                </div>
                <form id="edit-user-form">
                    <input type="hidden" id="edit-u-id">
                    <div class="form-group">
                        <label for="edit-u-name">Nombre del Padre / Madre</label>
                        <input type="text" id="edit-u-name" required>
                    </div>
                    <div class="form-group">
                        <label for="edit-u-children">Hijos y Categor√≠as</label>
                        <textarea id="edit-u-children" rows="2" required></textarea>
                        <small>Ej: Juan (Infantil), Maria (Juvenil)</small>
                    </div>
                    <div class="form-group">
                        <label for="edit-u-pass">Contrase√±a</label>
                        <input type="password" id="edit-u-pass" required>
                    </div>
                    <div class="form-group">
                        <label for="edit-u-role">Rol</label>
                        <select id="edit-u-role">
                            <option value="user">Padre (Usuario)</option>
                            <option value="admin">Administrador</option>
                        </select>
                    </div>
                    <div class="modal-actions">
                        <button type="button" class="btn-text close-modal">Cancelar</button>
                        <button type="submit" class="btn-primary">Guardar Cambios</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Modal para Aprobar Pago -->
        <div id="approve-payment-modal" class="modal">
            <div class="modal-content" style="max-width: 600px;">
                <div class="modal-header">
                    <h3>Confirmar Cobro</h3>
                    <button class="close-modal">&times;</button>
                </div>
                <div class="modal-body">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem;">
                        <div>
                            <p><strong>Comprobante:</strong></p>
                            <img id="approve-img-preview" src=""
                                style="width: 100%; border-radius: 8px; margin-top: 0.5rem; cursor: pointer;">
                            <p class="text-xs" style="margin-top: 0.5rem; color: #666;">Haz clic en la imagen para verla
                                en tama√±o completo.</p>
                        </div>
                        <div>
                            <div class="form-group">
                                <label>Usuario</label>
                                <p id="approve-user-name" style="font-weight: 600;"></p>
                            </div>
                            <div class="form-group">
                                <label>Mes a abonar</label>
                                <p id="approve-month" style="font-weight: 600;"></p>
                            </div>
                            <div class="form-group">
                                <label>Monto Informado</label>
                                <p id="approve-amount-reported"
                                    style="color: var(--text-muted); text-decoration: line-through;"></p>
                            </div>
                            <div class="form-group">
                                <label for="confirm-amount">Monto Cobrado Final ($)</label>
                                <input type="number" id="confirm-amount"
                                    style="font-size: 1.25rem; font-weight: 700; border: 2px solid var(--primary);"
                                    required>
                                <small>Ingresa el monto exacto que figura en el comprobante.</small>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-actions" style="margin-top: 2rem; display: flex; gap: 1rem;">
                    <button type="button" class="btn-text close-modal" style="flex:1">Cancelar</button>
                    <button id="btn-reject-payment" class="btn-action reject"
                        style="width: auto; padding: 0 1.5rem; height: 45px; border-radius: 8px;">Rechazar</button>
                    <button id="btn-confirm-approve" class="btn-primary" style="flex:2">Confirmar y Aprobar</button>
                </div>
            </div>
        </div>

        <!-- Modal para Rechazar Pago -->
        <div id="reject-payment-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Rechazar Pago</h3>
                    <button class="close-modal">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label for="reject-reason">Motivo del rechazo</label>
                        <textarea id="reject-reason" rows="3"
                            placeholder="Ej: El comprobante no es legible o el monto no coincide."
                            style="width: 100%; border-radius: 8px; border: 1px solid var(--border); padding: 0.5rem;"></textarea>
                    </div>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn-text close-modal">Cancelar</button>
                    <button id="btn-confirm-reject" class="btn-primary"
                        style="background-color: var(--danger);">Confirmar Rechazo</button>
                </div>
            </div>
        </div>

        <!-- Modal para Ficha del Atleta -->
        <div id="athlete-modal" class="modal">
            <div class="modal-content" style="max-width: 700px;">
                <div class="modal-header">
                    <h3>Datos del Atleta</h3>
                    <button class="close-modal">&times;</button>
                </div>
                <form id="athlete-form">
                    <input type="hidden" id="ath-index">
                    <div class="form-grid-2">
                        <div class="form-group">
                            <label for="ath-name">Nombre Completo</label>
                            <input type="text" id="ath-name" required readonly>
                        </div>
                        <div class="form-group">
                            <label for="ath-dni">DNI</label>
                            <input type="text" id="ath-dni" placeholder="Sin puntos" required>
                        </div>
                    </div>
                    <div class="form-grid-2">
                        <div class="form-group">
                            <label for="ath-category">Categor√≠a</label>
                            <select id="ath-category" required>
                                <option value="Infantil">Infantil</option>
                                <option value="U12">U12</option>
                                <option value="U14">U14</option>
                                <option value="U16">U16</option>
                                <option value="U18">U18</option>
                                <option value="U20">U20</option>
                                <option value="Mayores">Mayores</option>
                            </select>
                            <small>Para cambiar categor√≠a contacte al administrador.</small>
                        </div>
                        <div class="form-group">
                            <label for="ath-activity">Actividad / Categor√≠a de Cobro</label>
                            <select id="ath-activity" required>
                                <!-- Activities will be loaded here -->
                            </select>
                            <small>Esta actividad determina el costo de la cuota mensual.</small>
                        </div>
                    </div>
                    <div class="form-grid-2">
                        <div class="form-group">
                            <label for="ath-phone">Tel√©fono del Atleta</label>
                            <input type="tel" id="ath-phone" placeholder="Ej: 2944xxxxxx">
                        </div>
                        <div class="form-group">
                            <label for="ath-email">Correo Electr√≥nico de Contacto</label>
                            <input type="email" id="ath-email" required>
                        </div>
                    </div>
                    <div class="card" style="padding: 1rem; background: #f8fafc; margin-bottom: 1.5rem;">
                        <h4 style="margin-bottom: 1rem; font-size: 0.9rem; color: var(--primary);">Datos de los Padres /
                            Tutores</h4>
                        <div class="form-group">
                            <label for="ath-parents-names">Nombres de los Padres</label>
                            <input type="text" id="ath-parents-names" placeholder="Ej: Juan Perez y Maria Sosa"
                                required>
                        </div>
                        <div class="form-group">
                            <label for="ath-parents-phone">Tel√©fono de Contacto (Padres)</label>
                            <input type="tel" id="ath-parents-phone" placeholder="Emergencias" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="ath-address">Direcci√≥n Particular</label>
                        <input type="text" id="ath-address" placeholder="Calle, N√∫mero, Barrio" required>
                    </div>
                    <div class="modal-actions">
                        <button type="button" class="btn-text close-modal">Cerrar sin guardar</button>
                        <button type="submit" class="btn-primary">Guardar Ficha T√©cnica</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Toast Notifications -->
        <div id="toast-container"></div>
    </div>

    <!-- Scripts (Cargados en orden sin m√≥dulos) -->
    <script src="js/firebase-config.js"></script>
    <script src="js/data.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/app.js"></script>
</body>

</html>